<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galactic Games Launcher</title>
  <style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&display=swap');

:root {
    --neon: #4fc3ff;
    --neon-bright: #00ffff;
    --neon-soft: rgba(79,195,255,0.4);
    --metal-dark: #0b0f1a;
    --metal-light: #1e2742;
    --metal-shine: #2a4a7a;
    --gold: #ffd700;
}

html {
    height: 100%;
}

body {
    margin: 0;
    padding: 20px;
    font-family: "Orbitron", sans-serif;
    background:
        radial-gradient(ellipse at center top, #0a1f4d 0%, #030812 50%, #000000 100%);
    color: #e8f7ff;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    overflow-x: hidden;
    box-sizing: border-box;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background:
        radial-gradient(circle at 20% 50%, rgba(79, 195, 255, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
    pointer-events: none;
    z-index: 1;
}

body > * {
    position: relative;
    z-index: 2;
}

/* HEADER */
header {
    position: relative;
    text-align: center;
    margin-bottom: 10px;
}

header h1 {
    margin: 0;
    font-size: 42px;
    font-weight: 700;
    letter-spacing: 4px;
    background: linear-gradient(135deg, #00ffff, #4fc3ff, #ffd700, #00ffff);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: shimmer 8s ease-in-out infinite;
    text-shadow: 0 0 30px rgba(79, 195, 255, 0.5);
    filter: drop-shadow(0 0 15px rgba(79, 195, 255, 0.4)) drop-shadow(0 0 30px rgba(255, 215, 0, 0.2));
}

@keyframes shimmer {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* NAV TABS */
#nav-tabs {
    margin-top: 15px;
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

.nav-tab {
    padding: 10px 20px;
    border: 2px solid rgba(79, 195, 255, 0.4);
    background: rgba(11, 15, 26, 0.6);
    color: #e8f7ff;
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    letter-spacing: 1px;
}

.nav-tab:hover {
    border-color: rgba(79, 195, 255, 0.8);
    box-shadow: 0 0 20px rgba(79, 195, 255, 0.3);
}

.nav-tab.active {
    border-color: rgba(79, 195, 255, 1);
    background: linear-gradient(145deg, rgba(79, 195, 255, 0.2), rgba(255, 215, 0, 0.1));
    box-shadow: 0 0 30px rgba(79, 195, 255, 0.5), 0 0 15px rgba(255, 215, 0, 0.2);
    color: #00ffff;
}

/* GAME COUNTER */
#count {
    position: fixed;
    top: 10px;
    right: 10px;
    font-size: 14px;
    color: var(--neon);
    background: rgba(0, 0, 0, 0.6);
    padding: 5px 10px;
    border-radius: 8px;
    z-index: 10;
}

/* SEARCH */
#search {
    margin: 18px auto;
    max-width: 420px;
    width: 100%;
    padding: 14px 16px;
    border-radius: 12px;
    border: 2px solid rgba(79, 195, 255, 0.4);
    background: linear-gradient(145deg, rgba(13, 19, 38, 0.8), rgba(6, 9, 19, 0.9));
    color: white;
    font-family: inherit;
    font-size: 15px;
    outline: none;
    box-shadow:
        inset 0 2px 8px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(79, 195, 255, 0.2);
    transition: all 0.3s ease;
}

#search::placeholder {
    color: rgba(232, 247, 255, 0.5);
}

#search:focus {
    border-color: rgba(79, 195, 255, 0.8);
    box-shadow:
        inset 0 2px 8px rgba(0, 0, 0, 0.4),
        0 0 30px rgba(79, 195, 255, 0.4),
        0 0 20px rgba(255, 215, 0, 0.1);
    background: linear-gradient(145deg, rgba(13, 19, 38, 0.95), rgba(6, 9, 19, 0.95));
}

/* GRID */
#games-wrapper {
    flex: 1;
    overflow-y: auto;
    width: 100%;
}

#games {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    justify-content: center;
    gap: 22px;
    margin-top: 20px;
    padding: 0 10px;
}

/* GAME BUTTON */
.game-btn {
    width: 180px;
    height: 180px;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.15), transparent 50%),
                linear-gradient(145deg, rgba(42, 74, 122, 0.8), rgba(11, 15, 26, 0.9));
    color: #e8f7ff;
    font-family: inherit;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 0;
    overflow: visible;
    position: relative;
    box-shadow:
        inset 0 1px 20px rgba(79, 195, 255, 0.3),
        inset 0 -2px 15px rgba(0, 0, 0, 0.8),
        0 0 30px rgba(79, 195, 255, 0.3),
        0 0 60px rgba(255, 215, 0, 0.1),
        0 20px 40px rgba(0, 0, 0, 0.6);
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border: 2px solid rgba(79, 195, 255, 0.4);
}

.game-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
    border-radius: 50%;
    pointer-events: none;
}

.game-btn::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at 35% 35%, rgba(79, 195, 255, 0.15) 0%, transparent 60%);
    border-radius: 50%;
    pointer-events: none;
    opacity: 0;
}

.game-btn:hover {
    transform: translateY(-12px) scale(1.12);
    box-shadow:
        inset 0 1px 25px rgba(79, 195, 255, 0.5),
        inset 0 -2px 15px rgba(0, 0, 0, 0.8),
        0 0 50px rgba(79, 195, 255, 0.6),
        0 0 80px rgba(255, 215, 0, 0.25),
        0 30px 60px rgba(0, 0, 0, 0.8);
    border-color: rgba(79, 195, 255, 0.8);
}

.game-btn:hover::after {
    opacity: 1;
    animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    50% { transform: translate(-50%, -50%) scale(1.3); opacity: 0.3; }
}

.game-btn:focus {
    outline: none;
    box-shadow:
        inset 0 1px 25px rgba(79, 195, 255, 0.5),
        inset 0 -2px 15px rgba(0, 0, 0, 0.8),
        0 0 50px rgba(79, 195, 255, 0.6),
        0 0 80px rgba(255, 215, 0, 0.25);
}

/* IMAGE */
.game-btn img {
    width: 80%;
    height: 80%;
    object-fit: cover;
    background: linear-gradient(135deg, #2a4a7a, #0c1224);
    border-radius: 50%;
    transition: all 0.3s ease;
    filter: brightness(0.9) contrast(1.1);
    box-shadow: inset 0 0 20px rgba(79, 195, 255, 0.2);
    pointer-events: none;
}

.game-btn:hover img {
    filter: brightness(1.1) contrast(1.2) drop-shadow(0 0 15px rgba(79, 195, 255, 0.4));
}

/* TITLE */
.game-btn span {
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 0.8px;
    text-align: center;
    padding: 10px;
    text-shadow: 
        0 0 10px rgba(79, 195, 255, 0.8),
        0 0 20px rgba(79, 195, 255, 0.4),
        0 0 5px rgba(255, 215, 0, 0.3);
    max-width: 100%;
    word-wrap: break-word;
    overflow: hidden;
    text-overflow: ellipsis;
    flex-grow: 1;
    display: block;
    position: absolute;
    bottom: 10px;
    width: 100%;
    transition: all 0.3s ease-in-out;
    background: linear-gradient(180deg, transparent 0%, rgba(11, 15, 26, 0.9) 50%, rgba(11, 15, 26, 0.95) 100%);
    padding-top: 20px;
    opacity: 1;
    pointer-events: none;
}

/* Hover effect to enhance game name */
.game-btn:hover span {
    text-shadow: 
        0 0 15px rgba(79, 195, 255, 1),
        0 0 25px rgba(79, 195, 255, 0.6),
        0 0 8px rgba(255, 215, 0, 0.4);
}

/* STAR BUTTON */
.star-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    width: 28px;
    height: 28px;
    border: none;
    background: linear-gradient(145deg, rgba(255, 215, 0, 0.9), rgba(255, 215, 0, 0.7));
    color: #000;
    font-size: 16px;
    cursor: pointer;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5), inset 0 1px 8px rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
    z-index: 5;
    padding: 0;
    opacity: 0;
}

.game-btn:hover .star-btn {
    opacity: 1;
}

.star-btn.favorited {
    opacity: 1;
    background: linear-gradient(145deg, #ffed4e, #ffd700);
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.9), inset 0 1px 8px rgba(255, 255, 255, 0.5);
}

.star-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), inset 0 1px 8px rgba(255, 255, 255, 0.3);
}

.star-btn:active {
    transform: scale(0.95);
}

/* FOOTER */
footer {
    text-align: center;
    font-size: 13px;
    opacity: 0.8;
    padding-top: 20px;
    letter-spacing: 1px;
    text-shadow: 0 0 10px rgba(79, 195, 255, 0.3);
    background: linear-gradient(180deg, transparent, rgba(11, 15, 26, 0.3));
    padding-bottom: 15px;
}

/* EMPTY STATE */
#empty-state {
    text-align: center;
    margin-top: 60px;
    font-size: 20px;
    color: rgba(232, 247, 255, 0.6);
    letter-spacing: 1px;
}
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <header>
   <h1>üéÆ Math Helper Games üéÆ</h1>
   <div id="nav-tabs" style="margin-top: 15px; display: flex; gap: 15px; justify-content: center;">
     <button id="tab-all" class="nav-tab active" onclick="switchTab('all')">All Games</button>
     <button id="tab-favorites" class="nav-tab" onclick="switchTab('favorites')">‚≠ê Favorites</button>
   </div>
  </header>
  <input id="search" placeholder="Search the galaxy..." oninput="filterGames()">
  <div id="games-wrapper">
   <div id="games"></div>
   <div id="empty-state" style="display: none;">No games found</div>
  </div>
  <footer>
   Forged in orbit by the Math Helper Team
  </footer>
  <div id="count">
   0 games
  </div>
  <script>
let allGames = [];
let favorites = [];
let currentTab = 'all';

// Load favorites from localStorage
function loadFavorites() {
    const saved = localStorage.getItem('gamesFavorites');
    favorites = saved ? JSON.parse(saved) : [];
}

// Save favorites to localStorage
function saveFavorites() {
    localStorage.setItem('gamesFavorites', JSON.stringify(favorites));
}

// Check if game is favorited
function isFavorited(key) {
    return favorites.some(f => f.key === key);
}

// Add game to favorites
function addFavorite(game) {
    if (!isFavorited(game.key)) {
        favorites.push(game);
        saveFavorites();
        renderGames(currentTab === 'all' ? filterCurrentGames() : favorites);
        updateStarButtons();
    }
}

// Remove game from favorites
function removeFavorite(key) {
    favorites = favorites.filter(f => f.key !== key);
    saveFavorites();
    renderGames(currentTab === 'all' ? filterCurrentGames() : favorites);
    updateStarButtons();
}

// Switch between tabs
function switchTab(tab) {
    currentTab = tab;
    localStorage.setItem('gamesCurrentTab', tab);
    document.getElementById('tab-all').classList.toggle('active', tab === 'all');
    document.getElementById('tab-favorites').classList.toggle('active', tab === 'favorites');
    document.getElementById('search').style.display = tab === 'all' ? 'block' : 'none';
    
    if (tab === 'all') {
        renderGames(filterCurrentGames());
    } else {
        renderGames(favorites);
    }
}

function gameExists(key) {
    return allGames.some(g => g.key === key);
}

async function loadGames() {
    const owner = "beastcooper";
    const repo = "MHI_games";
    const branch = "master";
    const basePath = "offline";

    const api = async (path = "") => {
        const fullPath = path ? `${basePath}/${path}` : basePath;
        const res = await fetch(
            `https://api.github.com/repos/${owner}/${repo}/contents/${fullPath}?ref=${branch}`
        );
        return res.json();
    };

    try {
        const items = await api();

        if (!Array.isArray(items)) {
            console.error("Failed to load games", items);
            return;
        }

        for (const item of items) {
            if (item.type === "file") {
                const name = item.name.toLowerCase();
                if (name.endsWith(".html") || name.endsWith(".htm")) {
                    addGame(item.name.replace(/\.(html|htm)$/i, ""), item.download_url);
                }
            }
            if (item.type === "dir") {
                const files = await api(item.name);
                const index = files.find(f => {
                    const fname = f.name.toLowerCase();
                    return fname === "index.html" || fname === "index.htm";
                });
                if (index) addGame(item.name, index.download_url);
            }
        }

        allGames.sort((a, b) => a.name.localeCompare(b.name));
        renderGames(allGames);
        document.getElementById("count").textContent = `${allGames.length} games`;
    } catch (error) {
        console.error("Error loading games:", error);
    }
}

// Add game with automatic image mapping
function addGame(key, url) {
    if (gameExists(key)) return;

    // Automatically map image: same name as HTML/HTM
    const imageUrl = url.replace(/\.(html|htm)$/, ".png");

    allGames.push({
        key,
        name: key.replace(/[-_]/g, " "),
        url,
        image: imageUrl
    });
}

// Launch the game in a new tab
async function launchGame(url) {
    const res = await fetch(url);
    const html = await res.text();
    const win = window.open("about:blank");
    win.document.write(html);
    win.document.close();
}

// Get current filtered games for all tab
function filterCurrentGames() {
    const q = document.getElementById("search").value.toLowerCase();
    return allGames.filter(g => g.name.toLowerCase().includes(q));
}

// Update star button states
function updateStarButtons() {
    document.querySelectorAll('.star-btn').forEach(btn => {
        const key = btn.dataset.gameKey;
        if (isFavorited(key)) {
            btn.classList.add('favorited');
            btn.textContent = '‚òÖ';
        } else {
            btn.classList.remove('favorited');
            btn.textContent = '‚òÜ';
        }
    });
}

// Render buttons with images
function renderGames(list) {
    const grid = document.getElementById("games");
    const emptyState = document.getElementById("empty-state");
    grid.innerHTML = "";

    if (list.length === 0) {
        emptyState.style.display = 'block';
        return;
    }

    emptyState.style.display = 'none';

    list.forEach(game => {
        const btn = document.createElement("button");
        btn.className = "game-btn";
        btn.onclick = () => launchGame(game.url);

        const img = document.createElement("img");
        img.src = game.image;
        img.alt = game.name;
        img.onerror = () => img.style.display = "none";

        const title = document.createElement("span");
        title.textContent = game.name;

        const starBtn = document.createElement("button");
        starBtn.className = "star-btn";
        starBtn.dataset.gameKey = game.key;
        starBtn.textContent = isFavorited(game.key) ? '‚òÖ' : '‚òÜ';
        if (isFavorited(game.key)) {
            starBtn.classList.add('favorited');
        }
        starBtn.onclick = (e) => {
            e.stopPropagation();
            if (isFavorited(game.key)) {
                removeFavorite(game.key);
            } else {
                addFavorite(game);
            }
        };

        btn.append(img, title, starBtn);
        grid.appendChild(btn);
    });
}

// Search filter
function filterGames() {
    if (currentTab === 'all') {
        const searchValue = document.getElementById("search").value;
        localStorage.setItem('gamesSearchQuery', searchValue);
        renderGames(filterCurrentGames());
    }
}

// Initialize
loadFavorites();
loadGames();

// Restore saved state
window.addEventListener('DOMContentLoaded', () => {
    const savedTab = localStorage.getItem('gamesCurrentTab') || 'all';
    const savedSearch = localStorage.getItem('gamesSearchQuery') || '';
    
    document.getElementById("search").value = savedSearch;
    
    if (savedTab === 'favorites') {
        switchTab('favorites');
    }
});
  </script>
 </body>
</html>
